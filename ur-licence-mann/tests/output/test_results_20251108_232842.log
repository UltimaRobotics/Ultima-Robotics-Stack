==================================================
ur-licence-mann Test Suite
==================================================
Test started at: Sat Nov  8 11:28:42 PM UTC 2025

[0;32mBinary found: /home/runner/workspace/ur-licence-mann/build/ur-licence-mann[0m

---------------------------------------------------
Running: Initialization Test
---------------------------------------------------
Testing initialization with default config...
âœ— RSA keys not found
==========================================
VERBOSE FAILURE LOG:
==========================================
Operation: Initialize and generate RSA keys
Command: /home/runner/workspace/ur-licence-mann/build/ur-licence-mann --package-config /home/runner/workspace/ur-licence-mann/tests/test_data/test_package_config.json -v
Exit Code: 0

Expected Result:
  - RSA private key at: /home/runner/workspace/ur-licence-mann/tests/output/test_keys/private_key.pem
  - RSA public key at: /home/runner/workspace/ur-licence-mann/tests/output/test_keys/public_key.pem

Actual Result:
  - Private key exists: NO
  - Public key exists: NO

Command Output:
Loaded package config from: /home/runner/workspace/ur-licence-mann/tests/test_data/test_package_config.json
Initializing ur-licence-mann system...
Directories created/verified
Generating new RSA key pair...
[LOG] Generating RSA key pair...
[LOG] Key pair generated successfully
[LOG] Private key: /home/runner/workspace/ur-licence-mann/tests/tests/output/test_keys/private_key.pem
[LOG] Public key: /home/runner/workspace/ur-licence-mann/tests/tests/output/test_keys/public_key.pem
RSA key pair generated successfully
Private key permissions set to 0600 (owner read/write only)
RSA key pair consistency verified successfully
Generated new encryption keys: tests/output/test_keys/encryption_keys.json
WARNING: Store this file securely and consider using environment variables or secrets management
No license definitions file found, will be created on first use
Initialization complete.
Hardware binding: REQUIRED (enforced)
ur-licence-mann - Advanced License Management Tool

New Operation-Based Interface:
  --package-config <file>  Package configuration JSON file
  -o, --operation <op>     Operation: generate/verify/update/get_license_info/get_license_plan/get_license_definitions
  --operation-config <file> Operation configuration JSON file
  -v, --verbose            Enable verbose output

Examples:
  Initialize and generate keys:
    ./ur-licence-mann --package-config config.json

  Generate license:
    ./ur-licence-mann --package-config config.json -o generate --operation-config operation.json

  Verify license:
    ./ur-licence-mann --package-config config.json -o verify license_file=license.lic

  Get license info:
    ./ur-licence-mann --package-config config.json -o get_license_info license_file=license.lic

  Get license plan:
    ./ur-licence-mann --package-config config.json -o get_license_plan license_file=license.lic

  Get license definitions:
    ./ur-licence-mann --package-config config.json -o get_license_definitions

Note: Encryption keys are automatically generated on first run and stored securely.
      License definitions are automatically encrypted when auto_encrypt_definitions=true.
      All licenses include hardware fingerprints and signatures when required.
==========================================
[0;31mâœ— FAILED[0m: Initialization Test

---------------------------------------------------
Running: License Generation Test
---------------------------------------------------
Testing license generation...
âœ“ License file created
âœ“ License file has content
âœ“ License generation test passed
[0;32mâœ“ PASSED[0m: License Generation Test

---------------------------------------------------
Running: License Verification Test
---------------------------------------------------
Testing license verification...
âœ— License verification failed
==========================================
VERBOSE FAILURE LOG:
==========================================
Operation: Verify valid license
Parameters:
  - license_file: /home/runner/workspace/ur-licence-mann/tests/output/test_license.lic
  - check_expiry: false
Exit Code: 1

Expected Result:
  - Output should contain: 'License is VALID'

Actual Result:
  - License verification: FAILED

Command Output:
Loaded package config from: /home/runner/workspace/ur-licence-mann/tests/test_data/test_package_config.json
Initializing ur-licence-mann system...
Directories created/verified
Existing RSA key pair found, verifying consistency...
RSA key pair consistency verified successfully
RSA key pair is valid and consistent
Loaded existing encryption keys
No license definitions file found, will be created on first use
Initialization complete.
Hardware binding: REQUIRED (enforced)
[LOG] Starting license verification...
License is INVALID: Exception during verification: [json.exception.parse_error.101] parse error at line 1, column 1: syntax error while parsing value - invalid literal; last read: 'b'
==========================================
[0;31mâœ— FAILED[0m: License Verification Test

---------------------------------------------------
Running: Update Test
---------------------------------------------------
Testing license update...
âœ“ Updated license created
âœ— Updated license verification failed
==========================================
VERBOSE FAILURE LOG:
==========================================
Operation: Verify updated license
Parameters:
  - input_file: /home/runner/workspace/ur-licence-mann/tests/output/test_license.lic
  - output_file: /home/runner/workspace/ur-licence-mann/tests/output/updated_license.lic
  - new_expiry: 2027-12-31T23:59:59Z
Verify Exit Code: 1

Expected Result:
  - Updated license should be VALID

Actual Result:
  - Updated license verification: FAILED

Update Command Output:
Loaded package config from: /home/runner/workspace/ur-licence-mann/tests/test_data/test_package_config.json
Initializing ur-licence-mann system...
Directories created/verified
Existing RSA key pair found, verifying consistency...
RSA key pair consistency verified successfully
RSA key pair is valid and consistent
Loaded existing encryption keys
No license definitions file found, will be created on first use
Initialization complete.
Hardware binding: REQUIRED (enforced)
[LOG] Starting license verification...
License is INVALID: Exception during verification: [json.exception.parse_error.101] parse error at line 1, column 2: syntax error while parsing value - invalid literal; last read: 'f5'

Verification Output:
Loaded package config from: /home/runner/workspace/ur-licence-mann/tests/test_data/test_package_config.json
Initializing ur-licence-mann system...
Directories created/verified
Existing RSA key pair found, verifying consistency...
RSA key pair consistency verified successfully
RSA key pair is valid and consistent
Loaded existing encryption keys
No license definitions file found, will be created on first use
Initialization complete.
Hardware binding: REQUIRED (enforced)
[LOG] Starting license verification...
License is INVALID: Exception during verification: [json.exception.parse_error.101] parse error at line 1, column 2: syntax error while parsing value - invalid literal; last read: 'f5'
==========================================
[0;31mâœ— FAILED[0m: Update Test

---------------------------------------------------
Running: Update License Type Test
---------------------------------------------------
/home/runner/workspace/ur-licence-mann/tests/test_update_license_type.sh: line 2: ![CDATA[#!/bin/bash: No such file or directory
Testing license type update...
âœ“ Updated license created
âœ“ License type updated successfully to UltimaProfessionalLicence
âœ“ License type update test passed
[0;32mâœ“ PASSED[0m: Update License Type Test

---------------------------------------------------
Running: Get License Info Test
---------------------------------------------------
Testing get license info...
âœ“ Found field: license_id
âœ“ Found field: product
âœ“ Found field: customer_name
âœ“ Found field: customer_email
âœ“ Get license info test passed
[0;32mâœ“ PASSED[0m: Get License Info Test

---------------------------------------------------
Running: Get License Plan Test
---------------------------------------------------
Testing get license plan...
âœ“ License plan contains expected fields
âœ“ Get license plan test passed
[0;32mâœ“ PASSED[0m: Get License Plan Test

---------------------------------------------------
Running: Encryption Test
---------------------------------------------------
Testing license encryption...
âœ“ Encrypted license verified successfully
âœ“ Encryption test passed
[0;32mâœ“ PASSED[0m: Encryption Test

---------------------------------------------------
Running: Hardware Binding Test
---------------------------------------------------
Testing hardware binding...
âœ“ Hardware binding information present in license
âœ“ Hardware binding test passed
[0;32mâœ“ PASSED[0m: Hardware Binding Test

---------------------------------------------------
Running: Builtin Encryption Key Test
---------------------------------------------------
Testing Build-time Encryption Key Feature...
==============================================
Step 1: Generating license with automatic encryption...
Loaded package config from: /home/runner/workspace/ur-licence-mann/config/package_config.json
Initializing ur-licence-mann system...
Directories created/verified
Generating new RSA key pair...
[LOG] Generating RSA key pair...
[LOG] Key pair generated successfully
[LOG] Private key: /home/runner/workspace/ur-licence-mann/tests/./keys/private_key.pem
[LOG] Public key: /home/runner/workspace/ur-licence-mann/tests/./keys/public_key.pem
RSA key pair generated successfully
Private key permissions set to 0600 (owner read/write only)
RSA key pair consistency verified successfully
Generated new encryption keys: ./keys/encryption_keys.json
WARNING: Store this file securely and consider using environment variables or secrets management
No license definitions file found, will be created on first use
Initialization complete.
Hardware binding: REQUIRED (enforced)
ur-licence-mann - Advanced License Management Tool

New Operation-Based Interface:
  --package-config <file>  Package configuration JSON file
  -o, --operation <op>     Operation: generate/verify/update/get_license_info/get_license_plan/get_license_definitions
  --operation-config <file> Operation configuration JSON file
  -v, --verbose            Enable verbose output

Examples:
  Initialize and generate keys:
    ./ur-licence-mann --package-config config.json

  Generate license:
    ./ur-licence-mann --package-config config.json -o generate --operation-config operation.json

  Verify license:
    ./ur-licence-mann --package-config config.json -o verify license_file=license.lic

  Get license info:
    ./ur-licence-mann --package-config config.json -o get_license_info license_file=license.lic

  Get license plan:
    ./ur-licence-mann --package-config config.json -o get_license_plan license_file=license.lic

  Get license definitions:
    ./ur-licence-mann --package-config config.json -o get_license_definitions

Note: Encryption keys are automatically generated on first run and stored securely.
      License definitions are automatically encrypted when auto_encrypt_definitions=true.
      All licenses include hardware fingerprints and signatures when required.
ERROR: Encrypted license file not created: /home/runner/workspace/ur-licence-mann/tests/output/builtin_encrypted_license.lic.enc
[0;31mâœ— FAILED[0m: Builtin Encryption Key Test

---------------------------------------------------
Running: Auto Encrypt Definitions Test
---------------------------------------------------
Testing Automatic Definitions Encryption Feature...
====================================================
Step 1: Updating definitions (should auto-encrypt)...
Loaded package config from: /home/runner/workspace/ur-licence-mann/tests/output/auto_encrypt_pkg_config.json
Initializing ur-licence-mann system...
Directories created/verified
Existing RSA key pair found, verifying consistency...
RSA key pair consistency verified successfully
RSA key pair is valid and consistent
Loaded existing encryption keys
Encrypting license definitions file...
License definitions encrypted: /home/runner/workspace/ur-licence-mann/tests/output/test_definitions.enc
Initialization complete.
Hardware binding: REQUIRED (enforced)
ur-licence-mann - Advanced License Management Tool

New Operation-Based Interface:
  --package-config <file>  Package configuration JSON file
  -o, --operation <op>     Operation: generate/verify/update/get_license_info/get_license_plan/get_license_definitions
  --operation-config <file> Operation configuration JSON file
  -v, --verbose            Enable verbose output

Examples:
  Initialize and generate keys:
    ./ur-licence-mann --package-config config.json

  Generate license:
    ./ur-licence-mann --package-config config.json -o generate --operation-config operation.json

  Verify license:
    ./ur-licence-mann --package-config config.json -o verify license_file=license.lic

  Get license info:
    ./ur-licence-mann --package-config config.json -o get_license_info license_file=license.lic

  Get license plan:
    ./ur-licence-mann --package-config config.json -o get_license_plan license_file=license.lic

  Get license definitions:
    ./ur-licence-mann --package-config config.json -o get_license_definitions

Note: Encryption keys are automatically generated on first run and stored securely.
      License definitions are automatically encrypted when auto_encrypt_definitions=true.
      All licenses include hardware fingerprints and signatures when required.
âœ“ Definitions encrypted successfully

Step 2: Reading encrypted definitions...
Loaded package config from: /home/runner/workspace/ur-licence-mann/tests/output/auto_encrypt_pkg_config.json
Initializing ur-licence-mann system...
Directories created/verified
Existing RSA key pair found, verifying consistency...
RSA key pair consistency verified successfully
RSA key pair is valid and consistent
Loaded existing encryption keys
Verifying encrypted license definitions file...
Encrypted license definitions verified successfully
Initialization complete.
Hardware binding: REQUIRED (enforced)
ur-licence-mann - Advanced License Management Tool

New Operation-Based Interface:
  --package-config <file>  Package configuration JSON file
  -o, --operation <op>     Operation: generate/verify/update/get_license_info/get_license_plan/get_license_definitions
  --operation-config <file> Operation configuration JSON file
  -v, --verbose            Enable verbose output

Examples:
  Initialize and generate keys:
    ./ur-licence-mann --package-config config.json

  Generate license:
    ./ur-licence-mann --package-config config.json -o generate --operation-config operation.json

  Verify license:
    ./ur-licence-mann --package-config config.json -o verify license_file=license.lic

  Get license info:
    ./ur-licence-mann --package-config config.json -o get_license_info license_file=license.lic

  Get license plan:
    ./ur-licence-mann --package-config config.json -o get_license_plan license_file=license.lic

  Get license definitions:
    ./ur-licence-mann --package-config config.json -o get_license_definitions

Note: Encryption keys are automatically generated on first run and stored securely.
      License definitions are automatically encrypted when auto_encrypt_definitions=true.
      All licenses include hardware fingerprints and signatures when required.
âœ“ Encrypted definitions read successfully

Step 3: Updating definitions via JSON parameter...
Loaded package config from: /home/runner/workspace/ur-licence-mann/tests/output/auto_encrypt_pkg_config.json
Initializing ur-licence-mann system...
Directories created/verified
Existing RSA key pair found, verifying consistency...
RSA key pair consistency verified successfully
RSA key pair is valid and consistent
Loaded existing encryption keys
Verifying encrypted license definitions file...
Encrypted license definitions verified successfully
Initialization complete.
Hardware binding: REQUIRED (enforced)
ur-licence-mann - Advanced License Management Tool

New Operation-Based Interface:
  --package-config <file>  Package configuration JSON file
  -o, --operation <op>     Operation: generate/verify/update/get_license_info/get_license_plan/get_license_definitions
  --operation-config <file> Operation configuration JSON file
  -v, --verbose            Enable verbose output

Examples:
  Initialize and generate keys:
    ./ur-licence-mann --package-config config.json

  Generate license:
    ./ur-licence-mann --package-config config.json -o generate --operation-config operation.json

  Verify license:
    ./ur-licence-mann --package-config config.json -o verify license_file=license.lic

  Get license info:
    ./ur-licence-mann --package-config config.json -o get_license_info license_file=license.lic

  Get license plan:
    ./ur-licence-mann --package-config config.json -o get_license_plan license_file=license.lic

  Get license definitions:
    ./ur-licence-mann --package-config config.json -o get_license_definitions

Note: Encryption keys are automatically generated on first run and stored securely.
      License definitions are automatically encrypted when auto_encrypt_definitions=true.
      All licenses include hardware fingerprints and signatures when required.
âœ“ Definitions updated via JSON successfully

Step 4: Verifying updated definitions...
ERROR: Updated definitions not found
[0;31mâœ— FAILED[0m: Auto Encrypt Definitions Test

---------------------------------------------------
Running: Update with Encryption Test
---------------------------------------------------
Testing License Update with Automatic Encryption...
====================================================
Step 1: Generating initial license...
Loaded package config from: /home/runner/workspace/ur-licence-mann/config/package_config.json
Initializing ur-licence-mann system...
Directories created/verified
Existing RSA key pair found, verifying consistency...
RSA key pair consistency verified successfully
RSA key pair is valid and consistent
Loaded existing encryption keys
No license definitions file found, will be created on first use
Initialization complete.
Hardware binding: REQUIRED (enforced)
ur-licence-mann - Advanced License Management Tool

New Operation-Based Interface:
  --package-config <file>  Package configuration JSON file
  -o, --operation <op>     Operation: generate/verify/update/get_license_info/get_license_plan/get_license_definitions
  --operation-config <file> Operation configuration JSON file
  -v, --verbose            Enable verbose output

Examples:
  Initialize and generate keys:
    ./ur-licence-mann --package-config config.json

  Generate license:
    ./ur-licence-mann --package-config config.json -o generate --operation-config operation.json

  Verify license:
    ./ur-licence-mann --package-config config.json -o verify license_file=license.lic

  Get license info:
    ./ur-licence-mann --package-config config.json -o get_license_info license_file=license.lic

  Get license plan:
    ./ur-licence-mann --package-config config.json -o get_license_plan license_file=license.lic

  Get license definitions:
    ./ur-licence-mann --package-config config.json -o get_license_definitions

Note: Encryption keys are automatically generated on first run and stored securely.
      License definitions are automatically encrypted when auto_encrypt_definitions=true.
      All licenses include hardware fingerprints and signatures when required.
ERROR: Initial encrypted license not created
[0;31mâœ— FAILED[0m: Update with Encryption Test

---------------------------------------------------
Running: Force Encryption Flags Test
---------------------------------------------------
Testing Force Encryption Flags...
==================================
Step 1: Checking device_config.h for force encryption flags...
âœ“ FORCE_LICENSE_ENCRYPTION is enabled
âœ“ FORCE_DEFINITIONS_ENCRYPTION is enabled
âœ“ BUILTIN_ENCRYPTION_KEY is defined

Step 2: Verifying license generation always encrypts...
Loaded package config from: /home/runner/workspace/ur-licence-mann/config/package_config.json
Initializing ur-licence-mann system...
Directories created/verified
Existing RSA key pair found, verifying consistency...
RSA key pair consistency verified successfully
RSA key pair is valid and consistent
Loaded existing encryption keys
No license definitions file found, will be created on first use
Initialization complete.
Hardware binding: REQUIRED (enforced)
ur-licence-mann - Advanced License Management Tool

New Operation-Based Interface:
  --package-config <file>  Package configuration JSON file
  -o, --operation <op>     Operation: generate/verify/update/get_license_info/get_license_plan/get_license_definitions
  --operation-config <file> Operation configuration JSON file
  -v, --verbose            Enable verbose output

Examples:
  Initialize and generate keys:
    ./ur-licence-mann --package-config config.json

  Generate license:
    ./ur-licence-mann --package-config config.json -o generate --operation-config operation.json

  Verify license:
    ./ur-licence-mann --package-config config.json -o verify license_file=license.lic

  Get license info:
    ./ur-licence-mann --package-config config.json -o get_license_info license_file=license.lic

  Get license plan:
    ./ur-licence-mann --package-config config.json -o get_license_plan license_file=license.lic

  Get license definitions:
    ./ur-licence-mann --package-config config.json -o get_license_definitions

Note: Encryption keys are automatically generated on first run and stored securely.
      License definitions are automatically encrypted when auto_encrypt_definitions=true.
      All licenses include hardware fingerprints and signatures when required.
WARNING: Encrypted file not found, checking if auto_encrypt_licenses is enabled in package_config

Step 3: Verifying all operations use builtin encryption key...
âœ“ Verification works with builtin encryption key
âœ“ Get license info works with builtin encryption key

All force encryption tests passed!
[0;32mâœ“ PASSED[0m: Force Encryption Flags Test

==================================================
Test Summary
==================================================
Total Tests:  13
[0;32mPassed:       7[0m
[0;31mFailed:       6[0m

Detailed log: /home/runner/workspace/ur-licence-mann/tests/output/test_results_20251108_232842.log
Test completed at: Sat Nov  8 11:28:43 PM UTC 2025
